<div class="historial-container" *ngIf="!loading">
    <div class="historial-card">
        <!-- HEADER -->
        <div class="historial-header">
            <h3>{{ cliente?.nombres }} {{ cliente?.apellidos }} - Historia Clínica</h3>
        </div>

        <!-- BODY -->
        <form [formGroup]="clienteForm" class="cliente-form-section">
            <!-- INFORMACIÓN PERSONAL -->
            <div class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-contact-icon lucide-contact"><path d="M16 2v2"/><path d="M7 22v-2a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2"/><path d="M8 2v2"/><circle cx="12" cy="11" r="3"/><rect x="3" y="4" width="18" height="18" rx="2"/></svg>
                <h4 style="margin-left: 3px;"> Información Personal</h4>
            </div>

            <div class="cliente-grid">
                <div class="input-group">
                    <label>Nombres</label>
                    <input type="text" formControlName="nombres" placeholder="Ej: Juan Carlos" appEnterNext>
                </div>

                <div class="input-group">
                    <label>Apellidos</label>
                    <input type="text" formControlName="apellidos" placeholder="Ej: Pérez García" appEnterNext>
                </div>

                <div class="input-group">
                    <label>Cédula</label>
                    <input type="text" formControlName="cedula" placeholder="1234567890" appEnterNext>
                </div>

                <div class="input-group">
                    <label>Teléfono</label>
                    <input type="text" formControlName="telefono" placeholder="0987654321" appEnterNext>
                </div>

                <div class="input-group">
                    <label>Email</label>
                    <input type="text" formControlName="email" placeholder="ejemplo@correo.com" appEnterNext>
                </div>

                <div class="input-group">
                    <label>País</label>
                    <input type="text" formControlName="pais" placeholder="Ecuador" appEnterNext>
                </div>

                <div class="input-group">
                    <label>Provincia</label>
                    <input type="text" formControlName="provincia" placeholder="Ej: Pichincha" appEnterNext>
                </div>

                <div class="input-group">
                    <label>Ciudad</label>
                    <input type="text" formControlName="ciudad" placeholder="Ej: Quito" appEnterNext>
                </div>

                <div class="input-group full-width">
                    <label>Dirección</label>
                    <input type="text" formControlName="direccion" placeholder="Ej: Av. Principal 123 y Secundaria" appEnterNext>
                </div>
            </div>
        </form>


        <!-- HISTORIAL CLÍNICO -->
        <form [formGroup]="form" (ngSubmit)="guardar()">
            <div class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard-clock-icon lucide-clipboard-clock"><path d="M16 14v2.2l1.6 1"/><path d="M16 4h2a2 2 0 0 1 2 2v.832"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h2"/><circle cx="16" cy="16" r="6"/><rect x="8" y="2" width="8" height="4" rx="1"/></svg>
                <h4 style="margin-left: 3px ;">Historial Clínico</h4>
            </div>


            <!-- OD / OI -->
            <div class="ojos-grid">
                <!-- OD -->
                <div class="ojo-card">
                    <h4>Ojo Derecho (OD)</h4>
                    <div class="ojo-inputs">
                        <div class="input-group">
                            <label>Esfera</label>
                            <input type="text" formControlName="odEsfera" appEnterNext>
                        </div>
                        <div class="input-group">
                            <label>Cilindro</label>
                            <input type="text" formControlName="odCilindro" appEnterNext>
                        </div>
                        <div class="input-group">
                            <label>Eje</label>
                            <input type="text" formControlName="odEje" appEnterNext>
                        </div>
                        <div class="input-group">
                            <label>AVSC</label>
                            <input type="text" formControlName="odAVSC" placeholder="20/29" appEnterNext>
                        </div>
                        <div class="input-group">
                            <label>AVCC</label>
                            <input type="text" formControlName="odAVCC" placeholder="20/40" appEnterNext>
                        </div>
                    </div>
                </div>

                <!-- OI -->
                <div class="ojo-card">
                    <h4>Ojo Izquierdo (OI)</h4>
                    <div class="ojo-inputs">
                        <div class="input-group">
                            <label>Esfera</label>
                            <input type="text" formControlName="oiEsfera" appEnterNext>
                        </div>
                        <div class="input-group">
                            <label>Cilindro</label>
                            <input type="text" formControlName="oiCilindro" appEnterNext>
                        </div>
                        <div class="input-group">
                            <label>Eje</label>
                            <input type="text" formControlName="oiEje" appEnterNext>
                        </div>
                        <div class="input-group">
                            <label>AVSC</label>
                            <input type="text" formControlName="oiAVSC" placeholder="20/29" appEnterNext>
                        </div>
                        <div class="input-group">
                            <label>AVCC</label>
                            <input type="text" formControlName="oiAVCC" placeholder="20/40" appEnterNext>
                        </div>
                    </div>
                </div>
            </div>
            <!-- MEDIDAS PRINCIPALES -->
            <div class="section-medidas">
                <div class="input-group">
                    <label>ADD</label>
                    <input type="text" formControlName="add" placeholder="2.00" appEnterNext>
                </div>
                <div class="input-group">
                    <label>DP</label>
                    <input type="text" formControlName="dp" placeholder="62" appEnterNext>
                </div>
                <div class="input-group">
                    <label>Altura</label>
                    <input type="text" formControlName="altura" placeholder="18.5" appEnterNext>
                </div>
            </div>

            <!-- SECCIÓN: MEDIDAS DEL ARMAZÓN -->
            <div class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-glasses"><circle cx="6" cy="15" r="4"/><circle cx="18" cy="15" r="4"/><path d="M6 11V9a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v2"/></svg>
                <h4 style="margin-left: 3px;">Medidas del Armazón</h4>
            </div>

            <div class="armazon-grid">
                <div class="input-group">
                    <label>H (Ancho del Aro)</label>
                    <input type="text" formControlName="armazonH" placeholder="52" appEnterNext>
                </div>
                <div class="input-group">
                    <label>V (Alto del Aro)</label>
                    <input type="text" formControlName="armazonV" placeholder="40" appEnterNext>
                </div>
                <div class="input-group">
                    <label>DM (Diagonal Mayor)</label>
                    <input type="text" formControlName="armazonDM" placeholder="60" appEnterNext>
                </div>
                <div class="input-group">
                    <label>P (Puente)</label>
                    <input type="text" formControlName="armazonP" placeholder="18" appEnterNext>
                </div>
                <div class="input-group">
                    <label>Tipo de Armazón</label>
                    <input type="text" formControlName="armazonTipo" placeholder="Completo / Ranurado / Otro" appEnterNext>
                </div>
                <div class="input-group">
                    <label>DNP OD (Derecha)</label>
                    <input type="text" formControlName="armazonDNP_OD" appEnterNext>
                </div>
                <div class="input-group">
                    <label>DNP OI (Izquierda)</label>
                    <input type="text" formControlName="armazonDNP_OI" appEnterNext>
                </div>
                <div class="input-group">
                    <label>Altura (Alt)</label>
                    <input type="text" formControlName="armazonAltura" appEnterNext>
                </div>
            </div>


            <!-- EXTRA -->
            <div class="section-extra">
                <div class="input-group">
                    <label>De</label>
                    <input type="text" formControlName="de" placeholder="Cerca / Lejos / DP" appEnterNext>
                </div>
                <div class="input-group">
                    <label>Color</label>
                    <input type="text" formControlName="color" placeholder="Negro / Transparente" appEnterNext>
                </div>
            </div>

            <!-- OBSERVACIÓN -->
            <div class="section-observacion">
                <label>Observación</label>
                <textarea rows="3" formControlName="observacion" placeholder="Notas adicionales..." appEnterNext></textarea>
            </div>
            <div class="section-title">
                <h4>Doctor que atendió</h4>
            </div>

            <div class="cliente-grid">
                <div class="input-group full-width">
                    <label>DR.</label>
                    <input type="text" formControlName="doctor" placeholder="Ej: Dr. Juan Pérez" appEnterNext />
                </div>
            </div>


            <!-- FOOTER -->
            <div class="historial-footer">
                <button type="button" class="btn-cancel" (click)="cancelar()">
          Cancelar
        </button>
                <button type="submit" class="btn-save">
          Guardar Todo
        </button>
            </div>
        </form>
    </div>
</div>