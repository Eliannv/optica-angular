<div class="auth-container">
    <!-- LADO IZQUIERDO -->
    <div class="auth-left">
        <h1 class="welcome-text">Recuperar Contraseña</h1>
        <img class="main-icon" src="img/Logo_Optica_Macias.png" alt="Logo Óptica">
        <p class="motivation-text">
            Te ayudamos a recuperar tu acceso
        </p>
    </div>

    <!-- LADO DERECHO -->
    <div class="auth-right">
        <!-- FORMULARIO DE RECUPERACIÓN -->
        <div class="form-slide" *ngIf="!emailSent()" @fadeSlide>
            <h2 class="auth-title">¿Olvidaste tu contraseña?</h2>
            <p class="auth-subtitle">
                Ingresa tu correo electrónico y te enviaremos un enlace para restablecer tu contraseña
            </p>

            <!-- Mensaje de error -->
            <div class="alert alert-danger" *ngIf="errorMessage()">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg> {{ errorMessage() }}
            </div>

            <form class="auth-form" [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()">
                <!-- Email -->
                <div class="form-group">
                    <label>Correo electrónico:</label>
                    <div class="input-wrapper">
                        <input type="email" formControlName="email" placeholder="ejemplo@optica.com" [class.invalid]="forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched" autofocus>
                        <div class="warning-icon" *ngIf="forgotPasswordForm.get('email')?.touched && forgotPasswordForm.get('email')?.invalid">
                            <span class="tooltip">
                                <ng-container *ngIf="forgotPasswordForm.get('email')?.hasError('required')">Correo requerido.<br></ng-container>
                                <ng-container *ngIf="forgotPasswordForm.get('email')?.hasError('email')">Formato de correo inválido.</ng-container>
                            </span>
                            <svg class="lucide lucide-message-circle-warning" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path>
                                <path d="M12 8v4"></path>
                                <path d="M12 16h.01"></path>
                            </svg>
                        </div>
                    </div>
                </div>

                <button class="auth-btn" type="submit" [disabled]="forgotPasswordForm.invalid || isLoading">
                    <span *ngIf="!isLoading">Enviar enlace de recuperación</span>
                    <span *ngIf="isLoading">Enviando...</span>
                </button>
            </form>

            <div style="text-align: center; margin-top: 1.5rem;">
                <a (click)="backToLogin()" style="color: var(--color-primary); cursor: pointer; text-decoration: none; font-size: 0.95rem;">
                    ← Volver al inicio de sesión
                </a>
            </div>
        </div>

        <!-- MENSAJE DE ÉXITO -->
        <div class="form-slide" *ngIf="emailSent()" @fadeSlide>
            <div style="text-align: center; padding: 2rem 0;">
                <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="var(--color-success)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin: 0 auto 1.5rem;">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                    <polyline points="22 4 12 14.01 9 11.01"></polyline>
                </svg>

                <h2 class="auth-title">¡Correo enviado!</h2>
                <p class="auth-subtitle" style="margin-bottom: 1.5rem;">
                    Hemos enviado un enlace de recuperación a <strong>{{ forgotPasswordForm.value.email }}</strong>
                </p>

                <div class="alert alert-info" style="text-align: left; margin-bottom: 1.5rem;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    <div>
                        <strong>Instrucciones:</strong>
                        <ol style="margin: 0.5rem 0 0 1.5rem; padding: 0;">
                            <li>Revisa tu bandeja de entrada</li>
                            <li>Haz clic en el enlace del correo</li>
                            <li>Se abrirá tu navegador para crear una nueva contraseña</li>
                            <li>Luego podrás iniciar sesión con tu nueva contraseña</li>
                        </ol>
                    </div>
                </div>

                <button class="auth-btn" (click)="backToLogin()" type="button">
                    Volver al inicio de sesión
                </button>
            </div>
        </div>
    </div>
</div>